package main

// THIS IS A GENERATED FILE. DO NOT MODIFY
// main.tmpl

import (
	qcontrollers "github.com/beaconsoftwarellc/quimby/controllers"
	qhttp "github.com/beaconsoftwarellc/quimby/http"
	"{{.BasePath}}/controllers"
	"github.com/beaconsoftwarellc/quimby/http"
    "github.com/beaconsoftwarellc/gadget/log"
)

//go:generate codegen definition.yaml

func main() {
	log.NewGlobal("{{.Name}}", log.FunctionFromEnv())
	// Constants are defined on http
	// see: https://golang.org/pkg/net/http/#
	specification := config.New()
	rootController := &qcontrollers.HealthCheckController{}
	server := qhttp.CreateRESTServer(fmt.Sprintf(":%d", specification.Port), rootController)
	server.Router.AddController(&qcontrollers.HealthCheckController{})
	server.Router.AddController(controllers.NewDocController(specification))

	{{ range $index, $controller := .Controllers }}{{$controller.Add}}
	{{ end }}
	log.Infof("Server starting ... http://localhost:%d/", specification.Port)
	log.Error(server.ListenAndServe())
}
